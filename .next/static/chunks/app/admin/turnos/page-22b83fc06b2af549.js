(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126],{1701:(e,r,n)=>{"use strict";n.d(r,{$:()=>o});var t=n(5155);let a=function(){for(var e,r,n=0,t="",a=arguments.length;n<a;n++)(e=arguments[n])&&(r=function e(r){var n,t,a="";if("string"==typeof r||"number"==typeof r)a+=r;else if("object"==typeof r)if(Array.isArray(r)){var o=r.length;for(n=0;n<o;n++)r[n]&&(t=e(r[n]))&&(a&&(a+=" "),a+=t)}else for(t in r)r[t]&&(a&&(a+=" "),a+=t);return a}(e))&&(t&&(t+=" "),t+=r);return t};function o(e){let{children:r,className:n,variant:o="primary",...i}=e;return(0,t.jsx)("button",{...i,className:a("px-4 py-2 rounded-xl font-semibold transition duration-200","primary"===o?"bg-lino-acento text-white hover:bg-purple-700":"bg-lino-fondo-secundario text-lino-texto hover:bg-lino-fondo",n),children:r})}},1961:(e,r,n)=>{Promise.resolve().then(n.bind(n,9016))},4409:(e,r,n)=>{"use strict";n.d(r,{N:()=>a});var t=n(5647);if("undefined"==typeof fetch)throw Error('\uD83D\uDEA8 "fetch" no est\xe1 definido en este entorno.');let a=(0,t.UU)("https://pogsyskvqfxanmjplbxn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBvZ3N5c2t2cWZ4YW5tanBsYnhuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMzMTIyMDUsImV4cCI6MjA2ODg4ODIwNX0.NbAtNtcmBakwvmbgR2jLuOlZvAvavsZ3qzFgUZy1Czc")},5695:(e,r,n)=>{"use strict";var t=n(8999);n.o(t,"useParams")&&n.d(r,{useParams:function(){return t.useParams}}),n.o(t,"useRouter")&&n.d(r,{useRouter:function(){return t.useRouter}})},9016:(e,r,n)=>{"use strict";n.r(r),n.d(r,{default:()=>l});var t=n(5155),a=n(2115),o=n(5695),i=n(4409),s=n(1701);function l(){let e=(0,o.useRouter)(),[r,n]=(0,a.useState)([]),[l,u]=(0,a.useState)(!0),[c,d]=(0,a.useState)("todos"),[m,f]=(0,a.useState)(""),[p,h]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{u(!0);let e=new Date;e.setHours(0,0,0,0);let r=i.N.from("consultas").select("\n          id,\n          fecha,\n          paciente ( nombre ),\n          tratamiento ( nombre )\n        ").order("fecha",{ascending:!0});if("hoy"===c){let n=e.toISOString(),t=new Date(e);t.setHours(23,59,59,999),r=r.gte("fecha",n).lte("fecha",t.toISOString())}if("futuros"===c){let e=new Date().toISOString();r=r.gt("fecha",e)}let{data:t,error:a}=await r;a?console.error("Error al obtener turnos:",a):n(t.map(e=>{var r,n,t,a;return{id:e.id,fecha:e.fecha,paciente:null!=(t=null==(r=e.paciente)?void 0:r[0])?t:{nombre:"Paciente desconocido"},tratamiento:null!=(a=null==(n=e.tratamiento)?void 0:n[0])?a:{nombre:"Tratamiento sin especificar"}}})),u(!1)})()},[c]);let D=async e=>{if(!confirm("\xbfEst\xe1s seguro de que quer\xe9s eliminar este turno?"))return;let{error:r}=await i.N.from("consultas").delete().eq("id",e);r?alert("Error al eliminar turno"):n(r=>r.filter(r=>r.id!==e))},b=r.filter(e=>{var r;return null==(r=e.paciente)?void 0:r.nombre.toLowerCase().includes(m.toLowerCase())});return(0,t.jsxs)("main",{className:"min-h-screen p-6 bg-lino-fondo text-lino-texto",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"\uD83D\uDCC5 Citas agendadas"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,t.jsx)(s.$,{onClick:()=>d("todos"),variant:"todos"===c?"primary":"secondary",children:"\uD83D\uDCCB Todos"}),(0,t.jsx)(s.$,{onClick:()=>d("hoy"),variant:"hoy"===c?"primary":"secondary",children:"\uD83D\uDCC6 Hoy"}),(0,t.jsx)(s.$,{onClick:()=>d("futuros"),variant:"futuros"===c?"primary":"secondary",children:"\uD83D\uDD1C Futuros"}),(0,t.jsx)(s.$,{onClick:()=>{let e=r.map(e=>{var r,n,t,a;let o=new Date(e.fecha).toLocaleString(),i=null!=(t=null==(r=e.paciente)?void 0:r.nombre)?t:"Paciente",s=null!=(a=null==(n=e.tratamiento)?void 0:n.nombre)?a:"Tratamiento";return"\uD83D\uDD52 ".concat(o,"\n\uD83D\uDC64 ").concat(i,"\n\uD83E\uDDF4 ").concat(s,"\n")}).join("\n---\n");h(e),navigator.clipboard.writeText(e),alert("Agenda copiada al portapapeles \uD83D\uDCCB")},children:"\uD83D\uDCE4 Exportar agenda"})]}),(0,t.jsx)("input",{type:"text",value:m,onChange:e=>f(e.target.value),placeholder:"\uD83D\uDD0D Buscar por paciente...",className:"mb-6 w-full p-2 border border-lino-borde rounded"}),l?(0,t.jsx)("p",{children:"Cargando turnos..."}):0===b.length?(0,t.jsx)("p",{children:"No hay turnos para mostrar."}):(0,t.jsx)("ul",{className:"space-y-2",children:b.map(r=>{var n,a;return(0,t.jsxs)("li",{className:"p-4 bg-white border border-lino-borde rounded-xl",children:[(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsx)("strong",{children:new Date(r.fecha).toLocaleString()}),(0,t.jsx)("br",{}),"\uD83D\uDC64 ",(null==(n=r.paciente)?void 0:n.nombre)||"Paciente desconocido",(0,t.jsx)("br",{}),"\uD83E\uDDF4 ",(null==(a=r.tratamiento)?void 0:a.nombre)||"Tratamiento sin especificar"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(s.$,{onClick:()=>e.push("/admin/turnos/".concat(r.id,"/editar")),variant:"secondary",children:"✏️ Editar"}),(0,t.jsx)(s.$,{onClick:()=>D(r.id),variant:"secondary",children:"\uD83D\uDDD1️ Eliminar"})]})]},r.id)})}),p&&(0,t.jsx)("textarea",{className:"mt-6 w-full p-2 border border-lino-borde rounded bg-lino-fondo-secundario",rows:6,readOnly:!0,value:p})]})}}},e=>{e.O(0,[647,441,964,358],()=>e(e.s=1961)),_N_E=e.O()}]);